<!DOCTYPE html>
<html>
<head>
	<style>
		body {
			/*font-family: "Rubik", sans-serif;*/
			font-family: "Fredoka", sans-serif;
			margin: 20px;
			background: #042A2B;
			color: #FCFCFC;
		}

		label {
			display: block;
			margin: 2px 10px;
		}
		
		input[type=text] {
			width: 60%;
			padding: 8px;
			margin: 10px 10px;
			box-sizing: border-box;
			background-color: #FCFCFC;
			border: 3px solid #5EB1BF;
			color: #042A2B;
		}

		input[type=text]:hover {
			border: 3px solid #54F2F2;
		}

		input[type=text]:focus {
			border-color: #F4E04D;
			box-shadow: 0px 0px 6px rgba(244, 224, 77, 0.6);
			outline: none;
		}

		button {
			margin: 10px 10px;
		}

		.hidden { display: none; }
	</style>

	<!--<link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;700;800&display=swap" rel="stylesheet">-->
    <link href:"https://fonts.google.com/specimen/Fredoka?query=fredoka" rel="stylesheet">
	<meta charset="utf-8" />
	<title>Cinderella Game</title>
</head>
<body>
	<h1 id="title">Welcome!</h1>
	<label id="nameLabel"> Enter Your Name</label>
	<input id="nameInput" type="text" placeholder="Your name" />
	<button id="sendBtn" disabled>Send</button>
	<p id="status">Connecting...</p>
	<button id="startBtn" class="hidden">Start Game</button>

	<script>
		const wsPort = 8080;
		const wsPath = '/';
		const ws = new WebSocket("wss://hadlee-giggliest-unpopulously.ngrok-free.dev/");

        ws.onopen = () => console.log("WS connected");
        ws.onerror = e => console.error("WS error", e);
		ws.onmessage = (e) => {
			const message = JSON.parse(e.data);
			// message.type
			switch (message.type)
			{
				case "joined":
					// variables
					//message.playerName
					//message.isHost
					//message.readyToStart

					// handle HTML here
					// hide inputs
					document.getElementById('nameInput').classList.add('hidden');
					document.getElementById('sendBtn').classList.add('hidden');
					document.getElementById('nameLabel').classList.add('hidden');
					
					// say hello
					document.getElementById('title').textContent = "Hi, " + message.playerName + "!";
					
					if(!message.readyToStart)
					{
						document.getElementById('status').textContent = 'Waiting for players...';
						if(message.isHost)
						{
							// show button, but grey
							document.getElementById('startBtn').classList.remove('hidden');
							document.getElementById('startBtn').disabled = true;
						}
					} else if(message.isHost)
					{
						document.getElementById('status').style.display = 'none';
						document.getElementById('startBtn').disabled = false;
						
					} else 
					{
						document.getElementById('status').textContent = 'Waiting for host...';
					}

					break;
				case "start_game":
					document.getElementById('startBtn').classList.add('hidden');
					document.getElementById('status').textContent = 'STARTING THE GAME!';

					break;
			}
		}

		const nameInput = document.getElementById('nameInput');
		const sendBtn = document.getElementById('sendBtn');
		const status = document.getElementById('status');
		const startBtn = document.getElementById('startBtn');

		ws.addEventListener('open', () => {
			status.textContent = 'Connected';
			sendBtn.disabled = false;
		});

		sendBtn.addEventListener('click', () => {
			const name = nameInput.value.trim();
			if (!name) return;
			// send the JSON to Unity
			ws.send(JSON.stringify({ type: "join", playerName: name }));
			status.textContent = 'Sent: ${name}';
		});

		startBtn.addEventListener('click', () => {
			ws.send(JSON.stringify({ type: "start_game"}));
			status.textContent = 'Game started!';
		});
	</script>
</body>
</html>

